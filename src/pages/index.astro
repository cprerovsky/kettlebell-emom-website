---
import Layout from '@/layouts/Layout.astro'
import PageHead from '@/components/PageHead.astro'
import BlogCard from '@/components/BlogCard.astro'
import { SITE } from '@/consts'
import { getAllPosts } from '@/lib/data-utils'

const pageTitle = `${SITE.title} | Stronger through Structure`
const pageDescription = SITE.description

// Get the 3 most recent blog posts
const allPosts = await getAllPosts()
const recentPosts = allPosts.slice(0, 3)
---

<Layout>
  <PageHead slot="head" title={pageTitle} description={pageDescription} />

  <!-- Hero Section -->
  <section class="py-16 md:py-20">
    <div class="container mx-auto px-6">
      <div class="max-w-4xl mx-auto text-center">
        <h1 class="text-4xl md:text-6xl font-extrabold text-foreground">
          Stop Scrolling. Start Swinging.
        </h1>
        <p class="mt-6 text-lg md:text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed">
          A structured kettlebell EMOM generator built by a software developer and dad who needed a plan that fits into a 20-minute window.
        </p>

        <!-- Phone Mockup Section -->
        <div class="flex justify-center mt-12 mb-8">
          <div class="bg-secondary p-2 sm:p-4 rounded-2xl sm:rounded-3xl shadow-2xl border border-border">
            <div id="screenshot-container" class="relative w-64 h-auto sm:w-80 bg-background rounded-xl sm:rounded-2xl overflow-hidden">
              <img src="/media/screenshot-1.webp" alt="Kettlebell EMOM app showing Big Timer display for clarity during high-intensity training" class="screenshot w-full h-auto transition-opacity duration-500 ease-in-out opacity-100">
              <img src="/media/screenshot-2.webp" alt="Kettlebell EMOM app showing Up Next screen to eliminate decision fatigue" class="screenshot w-full h-auto transition-opacity duration-500 ease-in-out opacity-0 absolute top-0 left-0">
              <img src="/media/screenshot-3.webp" alt="Kettlebell EMOM app workout completion screen" class="screenshot w-full h-auto transition-opacity duration-500 ease-in-out opacity-0 absolute top-0 left-0">
            </div>
          </div>
        </div>

        <div class="flex justify-center gap-4 flex-wrap">
          <a 
            href="https://apps.apple.com/at/app/kettlebell-emom/id6753604738?l=en-GB" 
            class="bg-gradient-to-r from-blue-400 to-indigo-600 hover:from-blue-500 hover:to-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transform hover:scale-105 transition-transform duration-300 inline-flex items-center"
          >
            <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M17.463 8.999l-4.95.001c-1.534 0-2.193.9-2.213 2.492l-.001 5.05c0 1.593.68 2.493 2.214 2.493l4.95-.001c1.534 0 2.213-.9 2.213-2.493v-5.05c0-1.592-.68-2.492-2.213-2.492zm-7.013 5.051c0-2.58 1.48-4.993 3.763-4.993h1.5c.414 0 .75.336.75.75s-.336.75-.75.75h-1.5c-1.534 0-2.263 1.593-2.263 3.493s.73 3.494 2.263 3.494h1.5c.414 0 .75.336.75.75s-.336.75-.75.75h-1.5c-2.283 0-3.763-2.413-3.763-4.994zM12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path>
            </svg>
            <span>Download on the App&nbsp;Store</span>
          </a>
        </div>
        
        <p class="mt-6 text-xs text-muted-foreground">iPhone first. Android coming soon.</p>
      </div>
    </div>
  </section>

  <!-- The Philosophy: Anti-Subscription Section -->
  <section class="py-20 sm:py-24 bg-muted/30">
    <div class="container mx-auto px-6">
      <div class="max-w-3xl mx-auto">
        <div class="text-center">
          <h2 class="text-3xl md:text-5xl font-extrabold text-foreground">
            You Own Your Kettlebells.<br />You Should Own Your App.
          </h2>
          <div class="mt-8 space-y-4 text-lg text-muted-foreground leading-relaxed">
            <p>
              I initially included a subscription because "that's what apps do," but I personally despise being "Netflix-ed" by every service.
            </p>
            <p>
              That's why I built Kettlebell EMOM with a <strong class="text-foreground">lifetime unlock option</strong>: pay once, own it forever. Yes, there's a monthly subscription if you want to test the waters first, but the goal is simple: focus on your training, not your monthly billing cycle.
            </p>
          </div>
        </div>

        <!-- Pricing Callout -->
        <div class="mt-12 space-y-6">
          <!-- Free to Start -->
          <a href="https://apps.apple.com/at/app/kettlebell-emom/id6753604738?l=en-GB" class="p-6 bg-green-500/10 rounded-xl border-2 border-green-500/30 block hover:border-green-500/50 hover:bg-green-500/15 transition-all duration-300">
            <div class="text-center">
              <p class="text-2xl md:text-3xl font-bold text-foreground">Free to Start</p>
              <p class="mt-2 text-muted-foreground">3 free workouts. No credit card required. See if it fits your routine.</p>
              <p class="mt-4 text-sm font-semibold text-green-600 dark:text-green-400">Download on the App Store â†’</p>
            </div>
          </a>

          <!-- Pricing Options -->
          <div class="grid md:grid-cols-2 gap-6">
            <!-- Monthly Option -->
            <div class="p-6 bg-secondary/50 rounded-xl border border-border">
              <div class="text-center">
                <p class="text-sm font-semibold text-muted-foreground uppercase tracking-wide">Monthly</p>
                <div class="mt-3 inline-flex items-baseline gap-1">
                  <span class="text-3xl font-extrabold text-foreground">$4.99</span>
                  <span class="text-muted-foreground">/month</span>
                </div>
                <p class="mt-3 text-sm text-muted-foreground">Test the waters. Cancel anytime.</p>
              </div>
            </div>

            <!-- Lifetime Option (Highlighted) -->
            <div class="p-6 bg-gradient-to-br from-blue-500/10 to-indigo-600/10 rounded-xl border-2 border-blue-500/30 relative">
              <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                <span class="bg-gradient-to-r from-blue-400 to-indigo-600 text-white text-xs font-bold px-3 py-1 rounded-full">BEST VALUE</span>
              </div>
              <div class="text-center">
                <p class="text-sm font-semibold text-muted-foreground uppercase tracking-wide">Lifetime</p>
                <div class="mt-3 inline-flex items-baseline gap-1">
                  <span class="text-3xl font-extrabold text-foreground">$29.99</span>
                  <span class="text-muted-foreground">one-time</span>
                </div>
                <p class="mt-3 text-sm font-semibold text-foreground">Pay once. Train forever.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- The Story Hook: Built from a 2023 Injury -->
  <section class="py-20 sm:py-24">
    <div class="container mx-auto px-6">
      <div class="max-w-4xl mx-auto">
        <div class="grid md:grid-cols-2 gap-12 items-center">
          <!-- Left: Image -->
          <div class="flex justify-center md:justify-start">
            <div class="w-full max-w-xs rounded-xl overflow-hidden border border-border shadow-lg">
              <img src="/media/blog/mri.webp?v=1" alt="MRI scan that inspired the developer to build a more efficient workout tool" class="w-full h-auto">
            </div>
          </div>

          <!-- Right: Story Content -->
          <div>
            <h2 class="text-3xl md:text-4xl font-extrabold text-foreground">
              Built from a 2023 Injury.
            </h2>
            <p class="mt-6 text-lg text-muted-foreground leading-relaxed">
              A herniated disc at my absolute low point became the obsession behind this project. Standard PT didn't cut it until I found a trainer who stopped treating me like glass and focused on structure, hard work, and compound movements.
            </p>
            <p class="mt-4 text-lg text-muted-foreground leading-relaxed">
              By late 2024, I was pain-free and stronger than before. But I needed a training tool that fit into a 20-minute window, delivered balanced sessions every time, and didn't require me to scroll through endless YouTube videos.
            </p>
            <p class="mt-4 text-lg text-muted-foreground leading-relaxed">
              So I coded my own solution. This app was shaped by feedback from the r/kettlebell community and months of real-world use.
            </p>
            <div class="mt-8">
              <a 
                href="/blog/herniated-disc-and-squats-made-me-code"
                class="inline-flex items-center gap-2 text-primary hover:text-primary/80 transition-colors font-semibold"
              >
                <span>Read the full story behind the app</span>
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Section 4: The Workout Logic (Heavy-Core-Finisher) -->
  <section class="py-20 sm:py-24 bg-secondary/30">
    <div class="container mx-auto px-6">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl md:text-4xl font-extrabold text-foreground">
          Balanced Rounds, Not Random Reps.
        </h2>
        <p class="mt-6 text-lg text-muted-foreground leading-relaxed">
          The generator uses a scientifically-informed three-stage logic to deliver balanced, effective sessions every time. No scrolling through exercise lists. No guessing if you're hitting all your targets.
        </p>

        <div class="mt-12 grid md:grid-cols-3 gap-8">
          <!-- Heavy Stage -->
          <div class="bg-background border border-border rounded-xl p-8">
            <div class="flex items-center gap-3 mb-6">
              <div class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-400 to-indigo-600 flex items-center justify-center text-white font-bold text-lg">
                1
              </div>
              <h3 class="text-xl font-bold text-foreground">Heavy</h3>
            </div>
            <p class="text-muted-foreground leading-relaxed">
              Build foundational strength with targeted, compound movements. Focus on perfect form and explosive power.
            </p>
          </div>

          <!-- Core Stage -->
          <div class="bg-background border border-border rounded-xl p-8">
            <div class="flex items-center gap-3 mb-6">
              <div class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-400 to-indigo-600 flex items-center justify-center text-white font-bold text-lg">
                2
              </div>
              <h3 class="text-xl font-bold text-foreground">Core</h3>
            </div>
            <p class="text-muted-foreground leading-relaxed">
              Transition to trunk stability and spinal support exercises. Build the muscular corset that protects your lower back.
            </p>
          </div>

          <!-- Finisher Stage -->
          <div class="bg-background border border-border rounded-xl p-8">
            <div class="flex items-center gap-3 mb-6">
              <div class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-400 to-indigo-600 flex items-center justify-center text-white font-bold text-lg">
                3
              </div>
              <h3 class="text-xl font-bold text-foreground">Finisher</h3>
            </div>
            <p class="text-muted-foreground leading-relaxed">
              Empty the tank with high-intensity, metabolic work. Leave nothing in the room - you earned it.
            </p>
          </div>
        </div>

        <div class="mt-12 bg-gradient-to-r from-blue-400/10 to-indigo-600/10 border border-blue-500/20 rounded-xl p-8 text-center">
          <p class="text-lg text-foreground font-semibold">
            Get a fully balanced session generated and ready to go in under 60 seconds.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section 5: Community-Driven Features -->
  <section class="py-20 sm:py-24">
    <div class="container mx-auto px-6">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl md:text-4xl font-extrabold text-foreground text-center mb-4">
          Built for the Community, by a Solo Developer.
        </h2>
        <p class="text-center text-lg text-muted-foreground mb-12">
          Every feature below exists because someone in the r/kettlebell community asked for it.
        </p>

        <div class="grid md:grid-cols-3 gap-8">
          <!-- Skip Button Feature -->
          <div class="bg-secondary/30 border border-border rounded-xl p-8">
            <div class="mb-6">
              <div class="w-12 h-12 bg-gradient-to-r from-blue-400 to-indigo-600 rounded-lg flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path>
                </svg>
              </div>
            </div>
            <h3 class="text-xl font-bold text-foreground mb-3">The Skip Button</h3>
            <p class="text-muted-foreground leading-relaxed">
              Added in version 1.3.0 because a user asked for a way to skip rest periods when they felt ready to move. Simple. Powerful.
            </p>
          </div>

          <!-- Form Support Feature -->
          <div class="bg-secondary/30 border border-border rounded-xl p-8">
            <div class="mb-6">
              <div class="w-12 h-12 bg-gradient-to-r from-blue-400 to-indigo-600 rounded-lg flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
              </div>
            </div>
            <h3 class="text-xl font-bold text-foreground mb-3">Form Support</h3>
            <p class="text-muted-foreground leading-relaxed">
              Every exercise card links directly to instructions to help you verify your form instantly. No more mid-set YouTube searches.
            </p>
          </div>

          <!-- Focus-First UI Feature -->
          <div class="bg-secondary/30 border border-border rounded-xl p-8">
            <div class="mb-6">
              <div class="w-12 h-12 bg-gradient-to-r from-blue-400 to-indigo-600 rounded-lg flex items-center justify-center">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                </svg>
              </div>
            </div>
            <h3 class="text-xl font-bold text-foreground mb-3">Focus-First UI</h3>
            <p class="text-muted-foreground leading-relaxed">
              Big numbers and music support so you can see your progress from across the room. Minimal distractions, maximum focus.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Latest from the Blog Section -->
  <section class="py-20 sm:py-24 bg-muted/30">
    <div class="container mx-auto px-6">
      <div class="max-w-3xl mx-auto">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl md:text-4xl font-extrabold text-foreground">Latest from the Blog</h2>
          <a 
            href="/blog" 
            class="text-primary hover:text-primary/80 transition-colors flex items-center gap-1 text-sm font-semibold"
          >
            <span>View all</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          </a>
        </div>
        
        {recentPosts.length > 0 ? (
          <div class="space-y-2">
            {recentPosts.map((post) => (
              <BlogCard entry={post} />
            ))}
          </div>
        ) : (
          <p class="text-muted-foreground text-center py-8">No blog posts yet. Check back soon!</p>
        )}
      </div>
    </div>
  </section>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const screenshots = document.querySelectorAll('#screenshot-container .screenshot');
    if (screenshots.length <= 1) return;

    let currentIndex = 0;
    const rotationInterval = 3000; // 3 seconds

    setInterval(() => {
      // Fade out the current screenshot
      screenshots[currentIndex].classList.remove('opacity-100');
      screenshots[currentIndex].classList.add('opacity-0');

      // Update the index to the next screenshot, looping back to the start
      currentIndex = (currentIndex + 1) % screenshots.length;

      // Fade in the new screenshot
      screenshots[currentIndex].classList.remove('opacity-0');
      screenshots[currentIndex].classList.add('opacity-100');
    }, rotationInterval);
  });
</script>
